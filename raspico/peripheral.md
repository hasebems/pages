# Rust Peripheral開発環境

[前に戻る](rp-pico.md)

- 問題意識
    - main()関数内で宣言されたペリフェラルの変数を、main()関数以外に持ち運ぶことができない。
    - 引数に入れると、copy Traitがないのなんのと言われる

- 現状の対応
    1. ペリフェラルを変数に出来る型で、グローバル変数化する。
        - グローバル変数は "static mut 大文字" と宣言
        - 型は rust-analyzer などで調べる
    1. グローバル変数は、型の宣言を Option でくるみ、初期値を None にする。
    1. 初期化処理の中で、init関数などを呼んで、この変数を初期化する。
    1. unsafe などを頻繁に書かなくて済むように、このペリフェラルをアクセスする関数を別途作成しておく。
        - 関数内は unsafe 内に if let Some(x) = &mut ペリフェラル名 {} と書き、xでアクセス
    1. 上記の関数を任意の箇所からコールして使う